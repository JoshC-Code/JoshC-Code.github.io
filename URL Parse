from urllib.parse import parse_qs, urlencode,  urlsplit, unquote
import openpyxl
import os

locationDict = {
    #list of ids to eb changed
}


os.chdir('')#add path to spreadsheet here

fb = 'Facebook.xlsx' #spreadsheet name

wb = openpyxl.load_workbook(fb)

sheet = wb['Sheet1'] #sheet name

for i in range(2,30): #range is the cell number for Link column

    number = i
    numString = str(number)
    #cellNum = 'AI' + numString #AI is usually where Links is, check before each run
    cellNum = 'LJ' + numString
    url = sheet[cellNum].value
    
    test_str = url
      
    # initializing substrings
    sub1 = "id"
    sub2 = "&"
      
    # getting index of substrings
    idx1 = ''
    idx2 = ''
    idx1 = test_str.index(sub1)
    idx2 = test_str.index(sub2)
      
    # length of substring 1 is added to
    # get string from next character
    res = test_str[idx1 + len(sub1) + 1: idx2]

    orgID = res
    Num = locationDict[orgID]

    param, newvalue = 'id', Num

    parsed = urlsplit(url)

    query_dict = parse_qs(parsed.query)

    query_dict[param][0] = newvalue

    query_new = urlencode(query_dict, doseq=True)

    parsed=parsed._replace(query=query_new)

    url_new = (parsed.geturl())

    #print(url_new)
    url_new.replace('%3A',':')
    #
    testCell = 'LJ' + numString
    sheet[testCell] = url_new
    
wb.save(fb)
